<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Зимние мандарины</title>
<style>
body {
    margin: 0;
    background: #000814;
    overflow: hidden;
    font-family: monospace;
}
canvas {
    display: block;
    margin: 0 auto;
    background: linear-gradient(#001d3d, #003566);
    image-rendering: pixelated;
}
</style>
</head>
<body>

<canvas id="game" width="360" height="520"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
ctx.imageSmoothingEnabled = false;

// ───── СОСТОЯНИЕ ─────
let player, mandarins, snowflakes, lives, score, gameOver;

function resetGame() {
    player = { x: 160, y: 360, w: 28, h: 70, speed: 3 };
    mandarins = [];
    snowflakes = [];
    lives = 5;
    score = 0;
    gameOver = false;
}
resetGame();

// ───── УПРАВЛЕНИЕ ─────
let keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

// ───── СПАВН ─────
function spawnMandarin() {
    mandarins.push({
        x: Math.random() * (canvas.width - 20),
        y: -20,
        speed: 1.5 + Math.random()
    });
}

function spawnSnow() {
    snowflakes.push({
        x: Math.random() * canvas.width,
        y: -5,
        speed: 0.5 + Math.random() * 0.8,
        size: 1 + Math.random() * 2
    });
}

// ───── ПЕРСОНАЖ ─────
function drawPlayer() {
    const x = player.x;
    const y = player.y;

    // голова
    ctx.fillStyle = "#f1c27d";
    ctx.fillRect(x + 6, y - 26, 16, 16);

    // волосы
    ctx.fillStyle = "#222";
    ctx.fillRect(x + 6, y - 26, 16, 5);

    // глаза
    ctx.fillRect(x + 9, y - 18, 2, 2);
    ctx.fillRect(x + 17, y - 18,
