<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ù–æ–≤–æ–≥–æ–¥–Ω–∏–µ —Å–∞–ª–∞—Ç—ã</title>
<style>
    body {
        margin: 0;
        background: black;
        overflow: hidden;
        touch-action: none;
        font-family: monospace;
    }
    canvas {
        display: block;
        margin: 0 auto;
        background: linear-gradient(#001122, #002244);
        image-rendering: pixelated;
    }
</style>
</head>
<body>

<canvas id="game" width="320" height="480"></canvas>
<audio id="music" src="music.mp3" loop></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
ctx.imageSmoothingEnabled = false;

const music = document.getElementById("music");
music.volume = 0.4;
document.body.addEventListener("click", () => music.play(), { once: true });

let player = {
    x: 148,
    y: 400,
    w: 24,
    h: 32,
    speed: 3
};

let salads = [];
let snowflakes = [];
let lives = 5;
let score = 0;
let gameOver = false;

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let left = false;
let right = false;

document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") left = true;
    if (e.key === "ArrowRight") right = true;
});
document.addEventListener("keyup", e => {
    if (e.key === "ArrowLeft") left = false;
    if (e.key === "ArrowRight") right = false;
});

window.addEventListener("deviceorientation", e => {
    if (e.gamma > 5) right = true;
    else right = false;
    if (e.gamma < -5) left = true;
    else left = false;
});

canvas.addEventListener("touchmove", e => {
    const x = e.touches[0].clientX / window.innerWidth * canvas.width;
    player.x = x - player.w / 2;
});

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function spawnSalad() {
    salads.push({
        x: Math.random() * (canvas.width - 32),
        y: canvas.height + 32,
        speed: 1.5 + Math.random()
    });
}

function spawnSnow() {
    snowflakes.push({
        x: Math.random() * canvas.width,
        y: -5,
        speed: 0.5 + Math.random()
    });
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –†–∏—Å–æ–≤–∞–Ω–∏–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function drawPlayer() {
    // –ø–∞–ª—å—Ç–æ
    ctx.fillStyle = "#555";
    ctx.fillRect(player.x, player.y, player.w, player.h);

    // —à–∞—Ä—Ñ
    ctx.fillStyle = "red";
    ctx.fillRect(player.x, player.y + 8, player.w, 4);

    // –≥–æ–ª–æ–≤–∞
    ctx.fillStyle = "#ffe0bd";
    ctx.fillRect(player.x + 6, player.y - 8, 12, 8);
}

// ü•ó 3D —Å–∞–ª–∞—Ç –æ–ª–∏–≤—å–µ –Ω–∞ —Ç–∞—Ä–µ–ª–∫–µ
function drawSalad(s) {
    const cx = s.x + 16;
    const cy = s.y + 12;

    // —Ç–µ–Ω—å
    ctx.fillStyle = "rgba(0,0,0,0.3)";
    ctx.beginPath();
    ctx.ellipse(cx, cy + 12, 14, 4, 0, 0, Math.PI * 2);
    ctx.fill();

    // —Ç–∞—Ä–µ–ª–∫–∞
    const plateGrad = ctx.createRadialGradient(cx-4, cy-4, 4, cx, cy, 14);
    plateGrad.addColorStop(0, "#ffffff");
    plateGrad.addColorStop(1, "#cccccc");
    ctx.fillStyle = plateGrad;
    ctx.beginPath();
    ctx.arc(cx, cy, 14, 0, Math.PI * 2);
    ctx.fill();

    ctx.strokeStyle = "#aaaaaa";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(cx, cy, 14, 0, Math.PI * 2);
    ctx.stroke();

    // —Å–∞–ª–∞—Ç (–≥–æ—Ä–∫–∞)
    const saladGrad = ctx.createRadialGradient(cx-4, cy-6, 4, cx, cy, 10);
    saladGrad.addColorStop(0, "#f3f3d0");
    saladGrad.addColorStop(1, "#cfcfa0");
    ctx.fillStyle = saladGrad;
    ctx.beginPath();
    ctx.arc(cx, cy - 4, 10, 0, Math.PI * 2);
    ctx.fill();

    // –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –æ–ª–∏–≤—å–µ
    const ingredients = [
        "#d9b382", // –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å
        "#7cb342", // –≥–æ—Ä–æ—à–µ–∫
        "#ff8f00", // –º–æ—Ä–∫–æ–≤—å
        "#fffde7"  // —è–π—Ü–æ
    ];

    for (let i = 0; i < 14; i++) {
        ctx.fillStyle = ingredients[Math.floor(Math.random() * ingredients.length)];
        ctx.fillRect(
            cx - 7 + Math.random() * 14,
            cy - 12 + Math.random() * 10,
            2,
            2
        );
    }

    // –±–ª–∏–∫
    ctx.fillStyle = "rgba(255,255,255,0.4)";
    ctx.beginPath();
    ctx.arc(cx - 5, cy - 7, 3, 0, Math.PI * 2);
    ctx.fill();
}

function drawLives() {
    for (let i = 0; i < lives; i++) {
        ctx.fillStyle = "green";
        ctx.fillRect(260 + i * 12, 12, 8, 12);
        ctx.fillStyle = "yellow";
        ctx.fillRect(264 + i * 12, 8, 2, 4);
    }
}

function drawSnow(f) {
    ctx.fillStyle = "white";
    ctx.fillRect(f.x, f.y, 2, 2);
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –õ–æ–≥–∏–∫–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function update() {
    if (gameOver) return;

    if (left) player.x -= player.speed;
    if (right) player.x += player.speed;

    player.x = Math.max(0, Math.min(canvas.width - player.w, player.x));

    if (Math.random() < 0.02) spawnSalad();
    if (Math.random() < 0.2) spawnSnow();

    salads.forEach((s, i) => {
        s.y -= s.speed;

        if (
            s.x < player.x + player.w &&
            s.x + 32 > player.x &&
            s.y < player.y + player.h &&
            s.y + 24 > player.y
        ) {
            salads.splice(i, 1);
            score++;
        } else if (s.y < -40) {
            salads.splice(i, 1);
            lives--;
            if (lives <= 0) gameOver = true;
        }
    });

    snowflakes.forEach((f, i) => {
        f.y += f.speed;
        if (f.y > canvas.height) snowflakes.splice(i, 1);
    });
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    snowflakes.forEach(drawSnow);
    salads.forEach(drawSalad);
    drawPlayer();
    drawLives();

    ctx.fillStyle = "white";
    ctx.fillText("–°–∞–ª–∞—Ç—ã: " + score, 10, 20);

    if (gameOver) {
        ctx.fillStyle = "rgba(0,0,0,0.7)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "white";
        ctx.textAlign = "center";
        ctx.fillText("–°–æ–±—Ä–∞–Ω–æ —Å–∞–ª–∞—Ç–æ–≤: " + score, canvas.width / 2, 220);
        ctx.fillText(
            "–í—ã –Ω–µ —Å–º–æ–≥–ª–∏ —Å—ä–µ—Å—Ç—å –≤—Å–µ",
            canvas.width / 2, 250
        );
        ctx.fillText(
            "–Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ —Å–∞–ª–∞—Ç—ã, –ø—Ä–∏–¥–µ—Ç—Å—è",
            canvas.width / 2, 270
        );
        ctx.fillText(
            "–æ—Ç–¥–∞—Ç—å —á–∞—Å—Ç—å –¥—Ä—É–∑—å—è–º",
            canvas.width / 2, 290
        );
        ctx.fillText(
            "–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º",
            canvas.width / 2, 310
        );
    }
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
